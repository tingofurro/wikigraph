<p>
 <b>
  hp-FEM
 </b>
 is a general version of the
 <a href="/wiki/Finite_element_method" title="Finite element method">
  finite element method
 </a>
 (FEM), a
 <a href="/wiki/Numerical_analysis" title="Numerical analysis">
  numerical
 </a>
 method for solving
 <a href="/wiki/Partial_differential_equation" title="Partial differential equation">
  partial differential equations
 </a>
 based on piecewise-polynomial
 <a href="/wiki/Approximation" title="Approximation">
  approximations
 </a>
 that employs elements of variable size
 <i>
  (h)
 </i>
 and polynomial degree
 <i>
  (p)
 </i>
 . The origins of hp-FEM date back to the pioneering work of Ivo Babuska et al.
 <sup class="reference" id="cite_ref-1">
  <a href="#cite_note-1">
   <span>
    [
   </span>
   1
   <span>
    ]
   </span>
  </a>
 </sup>
 who discovered that the finite element method converges
 <i>
  exponentially fast
 </i>
 when the mesh is refined using a suitable combination of h-refinements (dividing elements into smaller ones) and
 <a href="/wiki/P-FEM" title="P-FEM">
  p-refinements
 </a>
 (increasing their polynomial degree). The exponential convergence makes the method a very attractive choice compared to most other finite element methods which only converge with an algebraic rate. The exponential convergence of the hp-FEM was not only predicted theoretically but also observed by numerous independent researchers.
 <sup class="reference" id="cite_ref-2">
  <a href="#cite_note-2">
   <span>
    [
   </span>
   2
   <span>
    ]
   </span>
  </a>
 </sup>
 <sup class="reference" id="cite_ref-3">
  <a href="#cite_note-3">
   <span>
    [
   </span>
   3
   <span>
    ]
   </span>
  </a>
 </sup>
 <sup class="reference" id="cite_ref-4">
  <a href="#cite_note-4">
   <span>
    [
   </span>
   4
   <span>
    ]
   </span>
  </a>
 </sup>
</p>
<p>
</p>
<div class="toc" id="toc">
 <div id="toctitle">
  <h2>
   Contents
  </h2>
 </div>
 <ul>
  <li class="toclevel-1 tocsection-1">
   <a href="#Differences_from_standard_FEM">
    <span class="tocnumber">
     1
    </span>
    <span class="toctext">
     Differences from standard FEM
    </span>
   </a>
  </li>
  <li class="toclevel-1 tocsection-2">
   <a href="#Example:_the_Fichera_problem">
    <span class="tocnumber">
     2
    </span>
    <span class="toctext">
     Example: the Fichera problem
    </span>
   </a>
  </li>
  <li class="toclevel-1 tocsection-3">
   <a href="#Why_is_hp-FEM_so_efficient.3F">
    <span class="tocnumber">
     3
    </span>
    <span class="toctext">
     Why is hp-FEM so efficient?
    </span>
   </a>
  </li>
  <li class="toclevel-1 tocsection-4">
   <a href="#What_is_hp-adaptivity.3F">
    <span class="tocnumber">
     4
    </span>
    <span class="toctext">
     What is hp-adaptivity?
    </span>
   </a>
  </li>
  <li class="toclevel-1 tocsection-5">
   <a href="#Higher-order_shape_functions">
    <span class="tocnumber">
     5
    </span>
    <span class="toctext">
     Higher-order shape functions
    </span>
   </a>
  </li>
  <li class="toclevel-1 tocsection-6">
   <a href="#Open_source_hp-FEM_codes">
    <span class="tocnumber">
     6
    </span>
    <span class="toctext">
     Open source hp-FEM codes
    </span>
   </a>
  </li>
  <li class="toclevel-1 tocsection-7">
   <a href="#References">
    <span class="tocnumber">
     7
    </span>
    <span class="toctext">
     References
    </span>
   </a>
  </li>
 </ul>
</div>
<p>
</p>
<h2>
 <span class="mw-headline" id="Differences_from_standard_FEM">
  Differences from standard FEM
 </span>
 <span class="mw-editsection">
  <span class="mw-editsection-bracket">
   [
  </span>
  <a href="/w/index.php?title=Hp-FEM&amp;action=edit&amp;section=1" title="Edit section: Differences from standard FEM">
   edit
  </a>
  <span class="mw-editsection-bracket">
   ]
  </span>
 </span>
</h2>
<p>
 The hp-FEM differs from the standard (lowest-order) FEM in many aspects.
 <sup class="reference" id="cite_ref-5">
  <a href="#cite_note-5">
   <span>
    [
   </span>
   5
   <span>
    ]
   </span>
  </a>
 </sup>
</p>
<ul>
 <li>
  <b>
   Choice of higher-order shape functions
  </b>
  <sup class="noprint Inline-Template" style="white-space:nowrap;">
   [
   <i>
    <a href="/wiki/Wikipedia:Please_clarify" title="Wikipedia:Please clarify">
     <span title="The text in the vicinity of this tag needs examples for clarification (September 2011)">
      examples needed
     </span>
    </a>
   </i>
   ]
  </sup>
  : To begin with, the higher-degree polynomials in elements can be generated using different sets of shape functions. The choice of such set can influence dramatically the conditioning of the stiffness matrix, and in turn the entire solution process. This problem was first documented by Babuska et al.
  <sup class="reference" id="cite_ref-6">
   <a href="#cite_note-6">
    <span>
     [
    </span>
    6
    <span>
     ]
    </span>
   </a>
  </sup>
 </li>
 <li>
  <b>
   Automatic hp-adaptivity
  </b>
  : In the hp-FEM, an element can be hp-refined in many different ways. One way is to just increase its polynomial degree without subdividing it in space. Or, the element can be subdivided geometrically, and various polynomial degrees can be applied to the subelements. The number of element refinement candidates easily reaches 100 in 2D and 1000 in 3D. Therefore, clearly, one number indicating the size of error in an element is not enough to guide automatic hp-adaptivity (as opposed to adaptivity in standard FEM). Other techniques such as
  <i>
   reference solutions
  </i>
  or
  <i>
   analyticity considerations
  </i>
  must be employed to obtain more information about the
  <i>
   shape of error
  </i>
  in every element.
  <sup class="reference" id="cite_ref-7">
   <a href="#cite_note-7">
    <span>
     [
    </span>
    7
    <span>
     ]
    </span>
   </a>
  </sup>
 </li>
 <li>
  <b>
   Ratio of assembling and solution CPU times
  </b>
  : In standard FEM, the stiffness matrix usually is assembled quickly but it is quite large. Therefore, typically, the solution of the discrete problem consumes the largest part of the overall computing time. On the contrary, the stiffness matrices in the hp-FEM typically are much smaller, but (for the same matrix size) their assembly takes more time than in standard FEM. Mostly, this is due to the computational cost of higher-order numerical quadrature.
 </li>
 <li>
  <b>
   Analytical challenges
  </b>
  : The hp-FEM is more difficult to understand from the analytical point of view than standard FEM.
  <sup class="noprint Inline-Template" style="white-space:nowrap;">
   [
   <i>
    <a class="mw-redirect" href="/wiki/Wikipedia:Avoid_weasel_words" title="Wikipedia:Avoid weasel words">
     <span title="The material near this tag may use weasel words or too-vague attribution. (September 2011)">
      according to whom?
     </span>
    </a>
   </i>
   ]
  </sup>
  This concerns numerous techniques, such as the discrete maximum principles (DMP) for elliptic problems. These results state that, usually with some limiting assumptions on the mesh, the piecewise-polynomial FEM approximation obeys analogous maximum principles as the underlying elliptic PDE. Such results are very important since they guarantee that the approximation remain physically admissible, leaving no possibility of computing a negative density, negative concentration, or negative absolute temperature. The DMP are quite well understood for lowest-order FEM but completely unknown for the hp-FEM in two or more dimensions. First DMP in one spatial dimension were formulated recently.
  <sup class="reference" id="cite_ref-8">
   <a href="#cite_note-8">
    <span>
     [
    </span>
    8
    <span>
     ]
    </span>
   </a>
  </sup>
  <sup class="reference" id="cite_ref-9">
   <a href="#cite_note-9">
    <span>
     [
    </span>
    9
    <span>
     ]
    </span>
   </a>
  </sup>
 </li>
 <li>
  <b>
   Programming challenges
  </b>
  : It is much harder to implement a hp-FEM solver than standard FEM code. The multiple issues that need to be overcome include (but are not limited to): higher-order quadrature formulas, higher-order shape functions, connectivity and orientation information relating shape functions on the reference domain with basis functions in the physical domain, etc.
  <sup class="reference" id="cite_ref-10">
   <a href="#cite_note-10">
    <span>
     [
    </span>
    10
    <span>
     ]
    </span>
   </a>
  </sup>
 </li>
</ul>
<h2>
 <span class="mw-headline" id="Example:_the_Fichera_problem">
  Example: the Fichera problem
 </span>
 <span class="mw-editsection">
  <span class="mw-editsection-bracket">
   [
  </span>
  <a href="/w/index.php?title=Hp-FEM&amp;action=edit&amp;section=2" title="Edit section: Example: the Fichera problem">
   edit
  </a>
  <span class="mw-editsection-bracket">
   ]
  </span>
 </span>
</h2>
<p>
 The
 <a class="new" href="/w/index.php?title=Fichera_problem&amp;action=edit&amp;redlink=1" title="Fichera problem (page does not exist)">
  Fichera problem
 </a>
 (also called the Fichera corner problem) is a standard benchmark problem for adaptive FEM codes. One can use it to show the dramatic difference in the performance of standard FEM and the hp-FEM. The problem geometry is a cube with missing corner. The exact solution has a singular gradient (an analogy of infinite stress) at the center. The knowledge of the exact solution makes it possible to calculate the approximation error exactly and thus compare various numerical methods. For illustration, the problem was solved using three different versions of adaptive FEM: with linear elements, quadratic elements, and the hp-FEM.
</p>
<ul class="gallery mw-gallery-traditional">
 <li class="gallerybox" style="width: 155px">
  <div style="width: 155px">
   <div class="thumb" style="width: 150px;">
    <div style="margin:15px auto;">
     <a class="image" href="/wiki/File:Grad_fichera.png">
      <img alt="" data-file-height="523" data-file-width="425" height="120" src="//upload.wikimedia.org/wikipedia/en/thumb/a/a8/Grad_fichera.png/97px-Grad_fichera.png" srcset="//upload.wikimedia.org/wikipedia/en/thumb/a/a8/Grad_fichera.png/146px-Grad_fichera.png 1.5x, //upload.wikimedia.org/wikipedia/en/thumb/a/a8/Grad_fichera.png/195px-Grad_fichera.png 2x" width="97"/>
     </a>
    </div>
   </div>
   <div class="gallerytext">
    <p>
     Fichera problem: singular gradient.
    </p>
   </div>
  </div>
 </li>
 <li class="gallerybox" style="width: 155px">
  <div style="width: 155px">
   <div class="thumb" style="width: 150px;">
    <div style="margin:30px auto;">
     <a class="image" href="/wiki/File:Conv_fichera.png">
      <img alt="" data-file-height="480" data-file-width="640" height="90" src="//upload.wikimedia.org/wikipedia/en/thumb/4/4a/Conv_fichera.png/120px-Conv_fichera.png" srcset="//upload.wikimedia.org/wikipedia/en/thumb/4/4a/Conv_fichera.png/180px-Conv_fichera.png 1.5x, //upload.wikimedia.org/wikipedia/en/thumb/4/4a/Conv_fichera.png/240px-Conv_fichera.png 2x" width="120"/>
     </a>
    </div>
   </div>
   <div class="gallerytext">
    <p>
     Fichera problem: convergence comparison.
    </p>
   </div>
  </div>
 </li>
</ul>
<p>
 The convergence graphs show the approximation error as a function of the number of degrees of freedom (DOF). By DOF we mean (unknown) parameters that are needed to define the approximation. The number of DOF equals the size of the stiffness matrix. The reader can see in the graphs that the convergence of the hp-FEM is much faster than the convergence of both other methods. Actually, the performance gap is so huge that the linear FEM might not converge at all in reasonable time and the quadratic FEM would need hundreds of thousands or perhaps millions of DOF to reach the accuracy that the hp-FEM attained with approximately 17,000 DOF. Obtaining very accurate results using relatively few DOF is the main strength of the hp-FEM.
</p>
<h2>
 <span class="mw-headline" id="Why_is_hp-FEM_so_efficient.3F">
  Why is hp-FEM so efficient?
 </span>
 <span class="mw-editsection">
  <span class="mw-editsection-bracket">
   [
  </span>
  <a href="/w/index.php?title=Hp-FEM&amp;action=edit&amp;section=3" title="Edit section: Why is hp-FEM so efficient?">
   edit
  </a>
  <span class="mw-editsection-bracket">
   ]
  </span>
 </span>
</h2>
<p>
 Smooth functions can be approximated much more efficiently using large high-order elements than small piecewise-linear ones. This is illustrated in the figure below, where a 1D Poisson equation with zero Dirichlet boundary conditions is solved on two different meshes. The exact solution is the sin function.
</p>
<ul>
 <li>
  Left: mesh consisting of two linear elements.
 </li>
 <li>
  Right: mesh consisting of one quadratic element.
 </li>
</ul>
<p>
 <a class="image" href="/wiki/File:Grad_sin_h.png" title="Piecewise-linear approximation.">
  <img alt="Piecewise-linear approximation." data-file-height="212" data-file-width="403" height="212" src="//upload.wikimedia.org/wikipedia/en/c/cb/Grad_sin_h.png" width="403"/>
 </a>
 <a class="image" href="/wiki/File:Conv_sin_hp.png" title="Quadratic approximation.">
  <img alt="Quadratic approximation." data-file-height="206" data-file-width="402" height="206" src="//upload.wikimedia.org/wikipedia/en/6/68/Conv_sin_hp.png" width="402"/>
 </a>
</p>
<p>
 While the number of unknowns is the same in both cases (1 DOF), the errors in the corresponding norm are 0.68 and 0.20, respectively. This means that the quadratic approximation was roughly 3.5-times more efficient than the piecewise-linear one. When we proceed one step further and compare (a) four linear elements to (b) one quartic element (p=4), then both discrete problems will have three DOF but the quartic approximation will be approximately 40-times more efficient. When performing few more steps like this, the reader will see that the efficiency gap opens extremely fast.
</p>
<p>
 On the contrary, small low-order elements can capture small-scale features such as singularities much better than large high-order ones. The hp-FEM is based on an optimal combination of these two approaches which leads to exponential convergence.
</p>
<h2>
 <span class="mw-headline" id="What_is_hp-adaptivity.3F">
  What is hp-adaptivity?
 </span>
 <span class="mw-editsection">
  <span class="mw-editsection-bracket">
   [
  </span>
  <a href="/w/index.php?title=Hp-FEM&amp;action=edit&amp;section=4" title="Edit section: What is hp-adaptivity?">
   edit
  </a>
  <span class="mw-editsection-bracket">
   ]
  </span>
 </span>
</h2>
<p>
 Some FEM sites describe hp-adaptivity as a combination of h-adaptivity (splitting elements in space while keeping their polynomial degree fixed) and p-adaptivity (only increasing their polynomial degree). This is not entirely accurate. The hp-adaptivity is significantly different from both h- and p-adaptivity since the hp-refinement of an element can be done in many different ways. Besides a p-refinement, the element can be subdivided in space (as in h-adaptivity), but there are many combinations for the polynomial degrees on the subelements. This is illustrated in the figure on the right. For example, if a triangular or quadrilateral element is subdivided into four subelements where the polynomial degrees are allowed to vary by at most two, then this yields 3^4 = 81 refinement candidates (not considering polynomially anisotropic candidates). Analogously, splitting a hexahedron into eight subelements and varying their polynomial degrees by at most two yields 3^8 = 6,561 refinement candidates. Clearly, standard FEM error estimates providing one constant number per element are not enough to guide automatic hp-adaptivity.
</p>
<h2>
 <span class="mw-headline" id="Higher-order_shape_functions">
  Higher-order shape functions
 </span>
 <span class="mw-editsection">
  <span class="mw-editsection-bracket">
   [
  </span>
  <a href="/w/index.php?title=Hp-FEM&amp;action=edit&amp;section=5" title="Edit section: Higher-order shape functions">
   edit
  </a>
  <span class="mw-editsection-bracket">
   ]
  </span>
 </span>
</h2>
<p>
 In standard FEM one only works with shape functions associated with grid vertices (the so-called
 <i>
  vertex functions
 </i>
 ). In contrast to that, in the hp-FEM one moreover regards
 <i>
  edge functions
 </i>
 (associated with element edges),
 <i>
  face functions
 </i>
 (corresponding to element faces - 3D only), and
 <i>
  bubble functions
 </i>
 (higher-order polynomials which vanish on element boundaries). The following images show these functions (restricted to a single element):
</p>
<ul class="gallery mw-gallery-traditional">
 <li class="gallerybox" style="width: 155px">
  <div style="width: 155px">
   <div class="thumb" style="width: 150px;">
    <div style="margin:15px auto;">
     <a class="image" href="/wiki/File:Vertex_new.jpg">
      <img alt="" data-file-height="507" data-file-width="491" height="120" src="//upload.wikimedia.org/wikipedia/en/thumb/b/be/Vertex_new.jpg/116px-Vertex_new.jpg" srcset="//upload.wikimedia.org/wikipedia/en/thumb/b/be/Vertex_new.jpg/174px-Vertex_new.jpg 1.5x, //upload.wikimedia.org/wikipedia/en/thumb/b/be/Vertex_new.jpg/232px-Vertex_new.jpg 2x" width="116"/>
     </a>
    </div>
   </div>
   <div class="gallerytext">
    <p>
     Vertex function.
    </p>
   </div>
  </div>
 </li>
 <li class="gallerybox" style="width: 155px">
  <div style="width: 155px">
   <div class="thumb" style="width: 150px;">
    <div style="margin:15px auto;">
     <a class="image" href="/wiki/File:Edge_new.jpg">
      <img alt="" data-file-height="510" data-file-width="490" height="120" src="//upload.wikimedia.org/wikipedia/en/thumb/4/4f/Edge_new.jpg/115px-Edge_new.jpg" srcset="//upload.wikimedia.org/wikipedia/en/thumb/4/4f/Edge_new.jpg/173px-Edge_new.jpg 1.5x, //upload.wikimedia.org/wikipedia/en/thumb/4/4f/Edge_new.jpg/231px-Edge_new.jpg 2x" width="115"/>
     </a>
    </div>
   </div>
   <div class="gallerytext">
    <p>
     Edge function.
    </p>
   </div>
  </div>
 </li>
 <li class="gallerybox" style="width: 155px">
  <div style="width: 155px">
   <div class="thumb" style="width: 150px;">
    <div style="margin:15px auto;">
     <a class="image" href="/wiki/File:Face_new.jpg">
      <img alt="" data-file-height="506" data-file-width="493" height="120" src="//upload.wikimedia.org/wikipedia/en/thumb/b/b3/Face_new.jpg/117px-Face_new.jpg" srcset="//upload.wikimedia.org/wikipedia/en/thumb/b/b3/Face_new.jpg/175px-Face_new.jpg 1.5x, //upload.wikimedia.org/wikipedia/en/thumb/b/b3/Face_new.jpg/234px-Face_new.jpg 2x" width="117"/>
     </a>
    </div>
   </div>
   <div class="gallerytext">
    <p>
     Face function.
    </p>
   </div>
  </div>
 </li>
 <li class="gallerybox" style="width: 155px">
  <div style="width: 155px">
   <div class="thumb" style="width: 150px;">
    <div style="margin:15px auto;">
     <a class="image" href="/wiki/File:Bubble_new.jpg">
      <img alt="" data-file-height="505" data-file-width="481" height="120" src="//upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Bubble_new.jpg/114px-Bubble_new.jpg" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Bubble_new.jpg/171px-Bubble_new.jpg 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Bubble_new.jpg/229px-Bubble_new.jpg 2x" width="114"/>
     </a>
    </div>
   </div>
   <div class="gallerytext">
    <p>
     Bubble function.
    </p>
   </div>
  </div>
 </li>
</ul>
<p>
 Note: all these functions are defined in the entire element interior!
</p>
<h2>
 <span class="mw-headline" id="Open_source_hp-FEM_codes">
  Open source hp-FEM codes
 </span>
 <span class="mw-editsection">
  <span class="mw-editsection-bracket">
   [
  </span>
  <a href="/w/index.php?title=Hp-FEM&amp;action=edit&amp;section=6" title="Edit section: Open source hp-FEM codes">
   edit
  </a>
  <span class="mw-editsection-bracket">
   ]
  </span>
 </span>
</h2>
<ul>
 <li>
  <a class="external text" href="http://www.concepts.math.ethz.ch/" rel="nofollow">
   Concepts
  </a>
  : C/C++ hp-FEM/DGFEM/BEM library for elliptic equations developed at SAM, ETH Zurich (Switzerland) and in the group of K. Schmidt at TU Berlin (Germany).
 </li>
 <li>
  2dhp90, 3dhp90: Fortran codes for elliptic problems and Maxwell's equations developed by L. Demkowicz at ICES, UT Austin.
 </li>
 <li>
  PHAML: The Parallel Hierarchical Adaptive MultiLevel Project. Finite element software developed at the National Institute for Standards and Technology, USA, for numerical solution of 2D elliptic partial differential equations on distributed memory parallel computers and multicore computers using adaptive mesh refinement and multigrid solution techniques.
 </li>
 <li>
  <a href="/wiki/Hermes_Project" title="Hermes Project">
   Hermes Project
  </a>
  : C/C++/Python library for rapid prototyping of space- and space-time adaptive hp-FEM solvers for a large variety of PDEs and multiphysics PDE systems, developed by the hp-FEM group at the University of Nevada, Reno (USA), Institute of Thermomechanics, Prague (Czech Republic), and the University of West Bohemia in Pilsen (Czech Republic) - with the
  <a href="/wiki/Agros2D" title="Agros2D">
   Agros2D
  </a>
  engineering software built on top of the Hermes library.
 </li>
 <li>
  PHG: PHG is a toolbox for developing parallel adaptive finite element programs. It's suitable for h-, p- and hp-fem. PHG is currently under active development at State Key Laboratory of Scientific and Engineering Computing, Institute of Computational Mathematics and Scientific/Engineering Computing of Chinese Academy of Sciences(LSEC, CAS, China).PHG deals with conforming tetrahedral meshes and uses bisection for adaptive local mesh refinement and MPI for message passing. PHG has an object oriented design which hides parallelization details and provides common operations on meshes and finite element functions in an abstract way, allowing the users to concentrate on their numerical algorithms.
 </li>
 <li>
  <a href="/wiki/Deal.II" title="Deal.II">
   Deal.II
  </a>
  : deal.II is a free, open source library to solve partial differential equations using the finite element method.
 </li>
</ul>
